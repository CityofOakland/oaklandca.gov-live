{% set primaryDropdown = [
	{ short: 'en', long: 'English' },
	{ short: 'es', long: 'Español' },
	{ short: 'zh-TW', long: '中文' },
	{ short: 'vi', long: 'Tiếng Việt' }
] %}
{% set secondaryDropdown = [
	{ short: 'ceb', long: 'Cebuano' },
	{ short: 'km', long: 'ភាសាខ្មែរ' },
	{ short: 'zh-TW', long: '中文' },
	{ short: 'ko', long: '한국어' },
	{ short: 'en', long: 'English' },
	{ short: 'mn', long: 'монгол' },
	{ short: 'tl', long: 'Filipino' },
	{ short: 'es', long: 'Español' },
	{ short: 'hmn', long: 'Hmoob' },
	{ short: 'vi', long: 'Tiếng Việt' },
	{ short: 'ja', long: '日本語' },
	{ short: 'ar', long: 'العربية' }
] %}

<script>
    var container = document.body;
    var dom_observer = new MutationObserver(function(mutation) {
        document.getElementById('mainbar').style.top = container.style.top;
    });
    var config = { attributes: true };
    dom_observer.observe(container, config);

    function clear_languages() {
      var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
      if(!iframe) return;

      var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
      var restore_el = innerDoc.getElementsByTagName("button");

      for(var i = 0; i < restore_el.length; i++){
        if(restore_el[i].id.indexOf("restore") >= 0) {
          restore_el[i].click();
          var close_el = innerDoc.getElementsByClassName("goog-close-link");
          close_el[0].click();
          return;
        }
      }
    }
</script>

<div id="topbar" class="navbar">
    <div class="relative flex items-center justify-end h-8 px-0 text-white lg:justify-between lg:px-6 bg-green-1000 lg:bg-green-800">
        <p class="hidden lg:block"><b>Official Website for the City of Oakland</b> <span class="mx-1">|</span> <a class="hover:text-green-800 hover:underline" href="{{ siteUrl }}officials/sheng-thao">Mayor Sheng Thao</a></p>
        <nav class="flex items-center" id="top-navigation" name="Top Navigation">
            <ul class="flex items-center">
							{% for item in primaryDropdown %}
								<li class="hidden ml-4 lg:block"><a class="language" href="#googtrans(en|{{ item.short }})" onclick="{{ item.short == 'en' ? 'clear_languages()' : 'location.reload()' }}"><span lang="{{ item.short }}" class="notranslate">{{ item.long }}</span></a></li>
							{% endfor %}
            </li>
            <p class="hidden ml-4 lg:block">|</p>
            <li id="translate" class="fill-current has-submenu click">
                <a tabindex="0" id="navbar-dropdown-translate" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{ svg( '@webroot/dist/img/icon-translate.svg')|attr({ class: 'fill-current text-yellow-200 lg:hidden' }) }} {{ "Translate"|t }} {{ svg( '@webroot/dist/img/icon-arrow.svg')|attr({ class: 'fill-current' }) }}</a>
                <ul class="grid grid-cols-2 p-4 bg-green-800 components gap-x-6 lg:p-6" aria-labelledby="navbar-dropdown-translate">
									{% for item in secondaryDropdown %}
										<li><a class="underline focusable language" href="#googtrans(en|{{ item.short }})" onclick="{{ item.short == 'en' ? 'clear_languages()' : 'location.reload()' }}"><span lang="{{ item.short }}" class="notranslate">{{ item.long }}</span></a></li>
									{% endfor %}
                </ul>
            </li>
        </nav>
    </div>
</div>
<div id="mainbar" class="navbar">
    <div class="relative">
        <nav id="main-navigation" class="relative flex items-center justify-between px-4 text-white lg:px-6 bg-gray-1000" name="Main Navigation">
            <a id="home-link" class="flex items-center justify-center py-2 lg:py-2" href="{{ siteUrl }}" name="Home">
                {{ svg( '@webroot/dist/img/logo-oakland-tree.svg')|attr({ class: 'h-9 sm:h-10 w-14 md:h-10 lg:hidden fill-current text-gray-100 hover:text-gray-200' }) }}
                {{ svg( '@webroot/dist/img/logo-oakland.svg')|attr({ class: 'w-40 h-10 hidden lg:block fill-current text-gray-100 hover:text-gray-200' }) }}
                <span class="sr-only">Home</span>
            </a>

            <ul class="flex items-center list-none">
                {% for item in navigation.navigationMain.level(1).all() %}
                    <li class="hidden has-submenu click lg:block">
                        <a tabindex="0" id="navbar-dropdown-{{ item.heading|replace({' ': '-'})|lower }}" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{ item.heading }} {{ svg( '@webroot/dist/img/icon-arrow.svg')|attr({ class: 'fill-current' }) }}</a>
                        <ul class="grid px-6 pt-2 pb-6 bg-green-800 components md:grid-cols-3 gap-x-6" aria-labelledby="navbar-dropdown-{{ item.heading|replace({' ': '-'})|lower }}">
                            <li class="relative pt-4 pb-32">
                                <span class="block pt-3 text-3xl font-bold leading-tight">{{ item.heading }}</span>
                                {% if item.description %}<p class="pt-2" style="font-size:20px;line-height:1.5">{{ item.description }}</p>{% endif %}
                                {% if item.linkit %}
                                    <a class="button accent" href="{{ item.linkit.url }}">{{ item.linkit.text }}</a>
                                {% endif %}
                            </li>
                            {% set navItems = item.children.all() %}
                            <li>
                                <ul>
                                {% for navItem in navItems|slice(0, navItems|length/2) %}
                                    <li><a class="card {{ navItem.styleCard }}" href="{{ navItem.linkit.url }}">{{ navItem.linkit.text }}</a></li>
                                {% endfor %}
                                </ul>
                            </li>
                            <li>
                                <ul>
                                {% for navItem in navItems|slice(navItems|length/2, navItems|length) %}
                                    <li><a class="card {{ navItem.styleCard }}" href="{{ navItem.linkit.url }}">{{ navItem.linkit.text }}</a></li>
                                {% endfor %}
                                </ul>
                            </li>
                        </ul>
                    </li>
                {% endfor %}

                <li class="flex items-center justify-end ml-5 has-submenu click lg:justify-center" style="min-width:52px;">
                    <a 
                        tabindex="0" 
                        id="navbar-dropdown-search" 
                        data-toggle="dropdown" 
                        role="button" 
                        aria-label="Open Site Search"
                        aria-haspopup="true" 
                        aria-expanded="false"
                        data-affects="navbar-dropdown-mobile"
                        data-affects-class="disabled"
                    >{{ svg( '@webroot/dist/img/icon-magnifier.svg')|attr({ class: 'fill-current text-gray-900' }) }}{{ svg( '@webroot/dist/img/icon-x.svg')|attr({ class: 'fill-current text-white' }) }}</a>
                    <ul class="px-4 pt-2 pb-6 bg-green-800 lg:px-6" aria-labelledby="navbar-dropdown-search">
                        <li>
                            <h3 class="pt-6">Search Oakland.ca.gov</h3>
                            <form id="site-search-form" class="relative mt-4" action="{{ url('search') }}" role="search">
                                <label for="site-search" class="hidden-visually">Search?</label>
                                <input type="search" id="site-search" class="form-control" aria-label="Site Search" name="query" placeholder="Search for keywords" value="">
                                <button
																	aria-label="Site Search Button"
																	class="bg-yellow-500 border-none flex items-center justify-center m-0 p-0 absolute ltr:right-0 rtl:left-0 top-0 w-[3.25rem] h-[3.25rem]"
																	type="submit">
																	{{ svg( '@webroot/dist/img/icon-magnifier.svg')|attr({ class: 'fill-current text-gray-900' }) }}
																</button>
                            </form>
                        </li>
                        <li class="hidden lg:block">
                            <h3 class="pt-6">Popular on Oakland.ca.gov</h3>
                            <ul class="grid pt-4 list-none md:grid-cols-3 gap-x-6">
                                {% for navItem in navigation.linkits.all() %}
                                    <li><a class="card {{ navItem.styleCard }}" href="{{ navItem.linkit.url }}">{{ navItem.linkit.text }}</a></li>
                                {% endfor %}
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <nav id="mobile-navigation" class="text-white bg-green-800 lg:hidden" name="Mobile Navigation">
            <a tabindex="0" id="navbar-dropdown-mobile" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                {{ svg( '@webroot/dist/img/icon-menu.svg')|attr({ class: 'fill-current text-white' }) }}
                {{ svg( '@webroot/dist/img/icon-x.svg')|attr({ class: 'fill-current text-white' }) }}
                <span class="sr-only">Mobile Menu</span>
            </a>
            <ul aria-labelledby="navbar-dropdown-mobile" class="px-4 py-2">
                {% for item in navigation.navigationMain.level(1).all() %}
                    {% if item.toggle %}
                        {% if item.linkit %}
                            <li class="border-b border-green-600"><a class="focusable" href="{{ item.linkit.url }}">{{ item.heading }}</a></li>
                        {% endif %}
                    {% else %}
                        <li class="border-b border-green-600 has-submenu click">
                            <a 
                                tabindex="0" 
                                id="navbar-dropdown-mobile-{{ item.heading|replace({' ': '-'})|lower }}" 
                                role="button" 
                                aria-haspopup="true" 
                                aria-expanded="false" 
                                data-parent="#navbar-dropdown-mobile" 
                                data-toggle="dropdown" 
                                class="focusable"
                            >{{ item.heading }} <span>{{ svg( '@webroot/dist/img/icon-arrow.svg')|attr({ class: 'fill-current' }) }}</span></a>
                            <ul class="components" aria-labelledby="navbar-dropdown-mobile-{{ item.heading|replace({' ': '-'})|lower }}">
                                {% set navItems = item.children.all() %}
                                {% for navItem in navItems %}
                                    <li><a class="block p-4 bg-green-900 border-t border-green-600 focusable" href="{{ navItem.linkit.url }}">{{ navItem.linkit.text }}</a></li>
                                {% endfor %}
                                {% if item.linkit %}
                                    <li><a class="block p-4 bg-yellow-500 border-t border-green-600 focusable text-gray-1000" href="{{ item.linkit.url }}" style="color:#222222">{{ item.linkit.text }}</a></li>
                                {% endif %}
                            </ul>
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        </nav>
    </div>
</div>
