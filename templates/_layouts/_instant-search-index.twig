{% extends "_layout.twig" %}

{% do view.registerJsFile("https://cdn.polyfill.io/v2/polyfill.min.js?features=default,Array.prototype.includes,Array.prototype.find") %}
{% do view.registerCssFile("https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css") %}
{% do view.registerCssFile ("https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css") %}
{% do view.registerJsFile("https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4") %}

{% css %}
	{{ include("_css/algoliafilter.css") }}
{% endcss %}

{% if section is defined %}
	{% set relation = craft.entries.section(section).slug(slug).one() %}
	{% set bannerTitleSuffix = " for " ~ relation.title %}
{% endif %}

{% block content %}
	{% block pageBanner %}
		{{ craft.vite.script("src/js/algoliafilter.js") }}
		{{ include("_partials/_page-banners.twig", {
			bannerTitle: entry.title | replace(' Index', '') ~ bannerTitleSuffix ?? '',
		}) }}
	{% endblock %}
	<div class="@container z-0 relative bg-gray-100 py-6 sm:py-12 mt-6 sm:mt-12" id="search-bar-container">
		<div class="container px-6 @3xl:px-16 mx-auto text-right">
			<div class="flex flex-col sm:flex-row">
				<label class="hidden-visually" for="search-input">{{ searchInputText ?? 'Search this Index' }}</label>
				<input class="w-full appearance-none rounded-none p-2 md:py-4 md:px-8" id="search-input" name="keywords"
				       required type="search" value="">
			</div>
			{% if facets is defined %}
				<a class="mt-4 inline-block text-right text-gray-800 hover:text-gray-900" href="#" id="filter-reveal">Show
					Filters</a>
			{% endif %}
		</div>
	</div>
	<div class="invisible relative -z-10 h-0 overflow-hidden bg-gray-300 text-gray-700 opacity-0 trans trans-all"
	     id="algolia-filters">
		<div class="container -my-4 flex-col" id="facet-holder">
			{% if facets is defined %}
				{% for facet in facets %}
					<div id="{{ facet.container }}" class="facet-container"></div>
				{% endfor %}
			{% endif %}
		</div>
	</div>
	<section class="@container mt-16 z-0 relative bg-white py-6 sm:py-12">
		<div class="container px-6 @3xl:px-16 mx-auto">
			<div class="w-full">
				<div id="stats"></div>
				<div id="hits"></div>
				<div class="flex items-center text-2xl">
					<div class="inline-block" id="bottom-pagination"></div>
				</div>
			</div>
		</div>
	</section>

	<style>
		.ais-hits--item h2 b {
			text-decoration: underline;
		}
	</style>
{% endblock %}
