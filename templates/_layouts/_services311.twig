{% extends "_layout.twig" %}

{% do craft.app.elements.eagerLoadElements(
	className(entry),
	[entry],
	[
		'banner',
		'primaryUnit',
		'modules.buttons:buttons.entry:entry',
		'modules.buttons:buttons.entry:buttonIcon',
		'modules.buttons:buttons.manual:buttonIcon',
		'modules.icons:icons.icon:icon'
	]
) %}

{% for block in entry.modules %}
	{% do block.useMemoized(entry.modules) %}
{% endfor %}

{% set modules = entry.modules.all() ?? null %}

{% set bannerImage = entry.banner.one() ?? null %}

{% block content %}

	{% set breadcrumbs = [] %}
	{% if entry.primaryUnit|length %}
		{% set breadcrumbs = breadcrumbs|merge([
			{
				title: entry.primaryUnit.one().title,
				link: entry.primaryUnit.one().url
			},
		]) %}
	{% endif %}
	{% if entry.section %}
		{% set breadcrumbs = breadcrumbs|merge([
			{
				title: entry.section.name,
				link: siteUrl ~ entry.section.handle
			},
		]) %}
	{% endif %}

	{% if bannerImage %}
		<div class="leading-normal aspect-ratio-box aspect-ratio-1/4 banner">
			<div class="object-cover pt-2 pb-8 leading-none aspect-ratio md:pt-4 md:pb-6 min-h-2-1/2 md:min-h-4">
				<figure class="absolute inset-0 z-0">
					<img
						class="absolute inset-0 z-0 h-full w-full object-cover"
						style="object-position:{{ bannerImage.getFocalPoint('asCss') }};"
						src="{{ bannerImage.url }}"
						alt="{{ bannerImage.alt ?? bannerImage.title ?? bannerImage.filename }}">
				</figure>
				<div class="container py-0">
					{{ include("_components/partials/_breadcrumbs.twig") }}
				</div>
			</div>
		</div>
	{% endif %}
	<div id="content" style="position:relative;top:-5rem;"></div>
	{% for block in modules %}
		{% if block.level == 1 %}
			{{ include("modules/_#{block.type}") }}
		{% endif %}
	{% endfor %}
{% endblock %}
