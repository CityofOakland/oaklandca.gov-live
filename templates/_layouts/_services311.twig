{% extends '_layout.twig' %}

{% do craft.app.elements.eagerLoadElements(
  className(entry),
  [entry],
  ['banner']
) %}

{% block content %}
  {% set bannerImage = entry.banner | length ? {
      position: entry.banner[0].getFocalPoint('asCss'),
      src: entry.banner[0].url,
      alt: entry.banner[0].title ?? entry.banner[0].filename
    } : false %}

  {% set breadcrumbs = [] %}
  {% if entry.primaryUnit|length %}
    {% set breadcrumbs = breadcrumbs|merge([
      {
        title: entry.primaryUnit.one().title,
        link: entry.primaryUnit.one().url
      },
    ]) %}
  {% endif %}
  {% if entry.section %}
    {% set breadcrumbs = breadcrumbs|merge([
      {
        title: entry.section.name,
        link: siteUrl ~ entry.section.handle
      },
    ]) %}
  {% endif %}

{% if bannerImage | length %}
  <div class="leading-normal aspect-ratio-box aspect-ratio-1/4 banner">
    <div class="object-cover pt-2 pb-8 leading-none aspect-ratio md:pt-4 md:pb-6 min-h-2-1/2 md:min-h-4">
      <figure class="absolute inset-0 z-0">
        <img
          class="absolute inset-0 z-0 object-cover w-full h-full"
          style="object-position:{{ bannerImage.position }};"
          src="{{ bannerImage.src }}"
          alt="{{ bannerImage.alt }}">
      </figure>
      <div class="container py-0">
        <div class="relative flex flex-col items-start py-0 sm:justify-between sm:flex-row-reverse sm:items-center">
          {% include "_partials/_elements/_banner-google-translate.twig" with { paddingTop: "pt-0" } %}
          <div class="relative z-10 inline-block px-2 py-1 mt-4 text-xs text-green-800 bg-white rounded-sm shadow sm:mt-0 md:text-xs">
            <a class="text-green-800 hover:text-green-800 hover:underline" href="{{ siteUrl }}">
              Oakland
            </a> →
            {% for link in breadcrumbs ?? '' %}
              <a class="text-green-800 hover:text-green-800 hover:underline" href="{{ link.link }}">{{ link.title }}</a> →
            {% endfor %}
            <span class="font-bold">{{ entry.title }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endif %}

  {% if entry.modules is defined and entry.modules|length %}
    {% for block in entry.modules.level(1).all() %}
        {% include 'modules/_' ~ block.type %}
    {% endfor %}
  {% endif %}
{% endblock %}
